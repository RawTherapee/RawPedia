---
title: Sharpening jp
contributors:
  - Yz2house
---

<div class="pagetitle">

シャープニング

</div>
　ここでの説明は“シャープニング”と表現されていますが、RawTherapeeには他にも色々なタイプのシャープニング機能が備わっています-[エッジとマイクロコントラストや](edges_and_microcontrast/jp#エッジとマイクロコントラスト)[ウェーブレットなどを](wavelets/jp#ウェーブレット)参照して下さい。

　処理工程上、シャープニング機能はリサイズ機能の**前に**置かれていますので、フルサイズの画像に適用されます。従って、画像のリサイズ**後に**シャープニングを適用したい場合は、リサイズ後のシャープニングを使います。説明はリサイズ機能の項にあります。

## コントラストマスク

　これはシャープニングが作用する領域と作用しない領域の区別をする機能で、⟨コントラストのしきい値⟩と⟨ぼかしの半径⟩のスライダーでコントロールします。マスクを可視化するには"シャープニングのコントラストマスクのプレビュー"ボタン
![<File:Contrastmask-off.png>](Contrastmask-off.png "File:Contrastmask-off.png")を押します。但し、この機能は⟨シャープニング⟩機能が有効で、且つ、プレビュー画面の倍率が100％以上でないと働きません。

### アンシャープマスク

　[アンシャープマスク](https://en.wikipedia.org/wiki/Unsharp_mask)（USM）は、画像の見かけ上の[アキュータンス（英語）](https://en.wikipedia.org/wiki/Acutance)（エッジコントラスト）を増やす技法を使って、画像をはっきり見せるようにする機能ですが、技術的には本当に画像をシャープにしている訳ではありません。人間の視覚システムが引き起こす錯覚、例えば、[コーンスウィート錯視](https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AC%E3%82%A4%E3%82%AF%E3%83%BB%E3%82%AA%E3%83%96%E3%83%A9%E3%82%A4%E3%82%A8%E3%83%B3%E3%83%BB%E3%82%B3%E3%83%BC%E3%83%B3%E3%82%B9%E3%82%A6%E3%82%A3%E3%83%BC%E3%83%88%E9%8C%AF%E8%A6%96)や[マッハバンド](https://ja.wikipedia.org/wiki/%E3%83%9E%E3%83%83%E3%83%8F%E3%83%90%E3%83%B3%E3%83%89)を上手く利用しているのです。USMは、他のソフトウェアではハロが発生しやすい傾向にありますが、RawTherapeeは独特のしきい値スライダーを備えているので、ハロ発生を最小限に留めたまま、優れたシャープニング効果を得ることが出来ます。

#### 半径

　半径によって増幅させる細部の大きさを決定します、結果的にそれはシャープニングによるハロの幅にも関係します。一般に、シャープニングの質は半径が小さいほど高くなります。例えば、ISO値が低く、ピンボケや手振れのない画像であれば、半径の設定は0.5～0.7で十分です。

#### しきい値

[image:Usm_threshold.png](image:usm_threshold.png)

　"しきい値"ツールはノイズの増幅とハロ発生を抑え、シャープニングを意図したトーン内に収めるために役立ちます。この機能で、どの部分でシャープニングを行うかを決めるカーブを作ります。縦軸は不透明度を意味しており、最低値が0%で（透明になり、シャープニング効果が見えない）、最大値が100%（不透明でシャープニング効果が見える）です。横軸は輝度を意味し、どの輝度の範囲でシャープニングを行うか決めます。最も暗い部分が左端で、最も明るい部分が右端になります。ツールのヒントで紹介されているように、**Shift**キーを押しながら調整ポイントをドラッグして、各ポイントを個別に動かすことが出来ます。また、**Ctrl**キーを押しながら、ポイントを動かすと、その動きが
遅くなり、より微細な調整が可能です。

　右の調整ポイントの組み合わせを左に動かすと、ハイライト部分でのシャープニングが減ります。左側のポイントの組み合わせを右に動かすと、シャドウ部分でのシャープニングが減り、ダークノイズの増幅を抑えることが出来ます。

　デフォルトでは、殆どのケースで過剰なシャープニングやハロの発生がないように設定されており、100%の不透明度も中間トーンまでに制限しています。スクリーンショットからも分かるように、最も暗い部分にはUSMは適用されませんが、普通に暗い部分から明るい部分までの広い範囲でUSM
が適用されています。更に、USMの強さも、中間トーンの最大値から最も明るいポイントの0に向かって徐々に下がって行きます。この調整加減によってノイズの増大やハロの発生を抑えているのです。

#### 適用量

　*適用量*でシャープニングの強さをコントロールします。

#### エッジだけをシャープニング

　これを有効にすると画像のトーンが均一な部分はシャープニングされません。ノイズの多い画像に有効な機能です。

　有効にすると2つのスライダーが現れます：

- 　この*半径*はノイズを減らすのに使われます。ノイズが少なければ、小さい半径を使えますが、逆も真なりです。半径を大きくするとその画像処理に時間がかかります。
- 　*エッジの許容*は、ピクセルをノイズではなく輪郭として認識するためには、そのピクセルが近傍のピクセルとどれほど違いが必要であるかを設定するものです。USMの*しきい値*と非常に似ており、画像の質に大きく影響します。ISO値が低い画像（低ノイズ）場合は、1000以下の設定、ISO値の高い画像は2500～3000あるいはそれ以上の設定が望ましいでしょう。

#### ハロ抑制

　シャープニングが強過ぎた時に、画像の明るい部分の周りに発生するハロを抑制します。

- 　最大値は100で、アンシャープマスクフィルターの見た目の効果が減ります。

### RL デコンボリューション

　[RL
デコンボリューション](https://en.wikipedia.org/wiki/Richardson%E2%80%93Lucy_deconvolution)
（英語）という名前は、このアルゴリズムの開発者二人、RichardsonとLucyのイニシャルから取ったものです。\[<https://ja.wikipedia.org/wiki/%E7%82%B9%E6%8B%A1%E3%81%8C%E3%82%8A%E9%96%A2%E6%95%B0>　点像分布関数\]を使ってガウスぼかしに似たものを解析（つまり、ぼかしを取り除く）します。実際は、ガウスぼかしによるぼけとレンズの歪みや手振れで起こるぼけは、著しく性質の異なるものなので、スライダーで設定する半径の大きさが実際の画像のぼけの半径からかけ離れると、ハロなどのアーティファクトが発生することがあります。　

#### 半径

　半径は画像のガウスぼかしの標準偏差（シグマ）を限定します。トライ＆エラーで適切な値を探ります。

#### 量

　シャープでない画像とシャープな画像の混合を調整するスライダーです。

#### 減衰

　減衰は繰り返し動作の度にデコンボリューションの効果を弱めるためのものです。最もはっきりした詳細部分が更に先鋭化することを防ぐ効果を持ちます。はっきりしている詳細部分で過度のシャープニングが見られるようであれば、これで減衰を行います。

#### 繰り返し

　RLデコンボリューションは反復法を用いるアルゴリズムです。よって目標となる結果を得るために反復計算が必要となります。各反復計算を“繰り返し”と呼び、一回目の繰り返し作業の結果が次の繰り返し作業の起点となります。繰り返しが行われる度にぼけは除かれますが、その分演算時間が増え、ハロが発生する確率も増えます。従って、最適な繰り返しの回数はトライ＆エラーで求めますー多くの場合、デフォルトで設定されている繰り返し回数で十分だと考えられます。
